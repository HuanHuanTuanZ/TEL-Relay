计划中的完全重构，部分代码参考自AUX
